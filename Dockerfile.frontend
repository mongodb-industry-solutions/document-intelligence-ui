FROM node:22-alpine
WORKDIR /app
COPY frontend/package*.json ./
RUN npm install
COPY frontend/ .
# Passes environment variables during Docker build so Next.js embeds them into the JavaScript bundle
ARG NEXT_PUBLIC_INTERNAL_API_URL
ARG NEXT_PUBLIC_API_URL
ENV NEXT_PUBLIC_INTERNAL_API_URL=${NEXT_PUBLIC_INTERNAL_API_URL}
ENV NEXT_PUBLIC_API_URL=${NEXT_PUBLIC_API_URL}
# Set the port environment variable for Next.js
ENV PORT=8080
RUN npm run build
EXPOSE 8080
CMD ["npm", "run", "start"]